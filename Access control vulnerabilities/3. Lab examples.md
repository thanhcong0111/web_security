# Some cases of Access control vulnerabilities

## 1. Unprotected admin functionality

Go to the lab and view `robots.txt` by appending `/robots.txt` to the lab URL. 

Notice that the Disallow line discloses the path to the admin panel.

In the URL bar, replace `/robots.txt` with `/administrator-panel` to load the admin panel.

Delete carlos.

## 2. Unprotected admin functionality with unpredictable URL

Review the lab home page's source using Burp Suite or your web browser's developer tools.

Observe that it contains some JavaScript that discloses the URL of the admin panel.

Load the admin panel and delete carlos.

## 3. User role controlled by request parameter

Log on to the account with `username = wiener` and `password = peter`. Then look in the Burp Proxy section `/login` and you will get the following information: `Set-Cookie: Admin=false`

To change it to true, we find the `/my-account` part and do `Send to repeater` to
carry out an attack.

After `Send to repeater`, we found that there are not exist any admins. Therefore, change `Admin=true` and resend. The result is: 
```
<a href="/admin">
  Admin panel
</a>
```

Next, to change the content of website, just open running cookies and change the admin value to true.

## 4. User role can be modified in user profile

Log in using the supplied credentials and access your account page.

Use the provided feature to update the email address associated with your account.

Observe that the response contains your role ID.

Send the email submission request to Burp Repeater, add `"roleid":2` into the JSON in the request body, and resend it.

Observe that the response shows your roleid has changed to 2.

Browse to /admin and delete carlos.

## 5. User ID controlled by request parameter

Log in using the supplied credentials and go to your account page.

Note that the URL contains your username in the "id" parameter.

Send the request to Burp Repeater.

Change the "id" parameter to carlos.

Retrieve and submit the API key for carlos.

And the API's key of Carlos is: `5j0EkZyMv2I5o8iFtlWhsqnhLJD7wxRF`

## 6. User ID controlled by request parameter, with unpredictable user IDs

Find a blog post by carlos. Click on carlos and observe that the URL contains his user ID. Make a note of this ID.

Log in using the supplied credentials and access your account page.

Change the "id" parameter to the saved user ID.

Retrieve and submit the API key.

And the API's key of Carlos is: `xh5Bso5D4PvgdXsFNyVa4jbS8py6HS99`

## 7. User ID controlled by request parameter with data leakage in redirect

Log in using the supplied credentials and access your account page.

Send the request to Burp Repeater.

Change the "id" parameter to `carlos`.

Observe that although the response is now redirecting you to the home page, it has a body containing the API key belonging to `carlos`.

Submit the API key.

And the API's key of Carlos is: `mjo6pFzrMdRgxZcxb93P6Ku7gQp3M9lC`

## 8. User ID controlled by request parameter with password disclosure

Log in using the supplied credentials and access the user account page.

Change the "id" parameter in the URL to `administrator`.

View the response in Burp and observe that it contains the administrator's password.

Log in to the administrator account and delete carlos.

The administrator's password is: `sxpp2242u506mgmnsd90`

Clicking on `My account` again will bring up the `Admin panel`. So at this time, we have 
successfully seized power. According to the lab request, click `Delete carlos` and you are complete sincere
