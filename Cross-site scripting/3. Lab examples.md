# Some cases of Cross-site scripting

## 1. Stored XSS into HTML context with nothing encoded

Open the website and go to any. 

Scroll down to the comment section and leave a comment as follows:

- Comment: `<script>alert(1)</script>`
- Name: your name or a random name, such as: `ian`
- Email: a random email, such as: `ian@hacker.com`
- Website: `https://google.com`

Then choose to post comment.

## 2. Stored XSS into HTML context with nothing encoded

Enter the following into the comment box:
`<script>alert(1)</script>`

Enter a name, email and website.

Click "Post comment".

Go back to the blog.

## 3. DOM XSS in document.write sink using source location.search

Enter a random alphanumeric string into the search box.

Right-click and inspect the element, and observe that your random string has been placed inside an img src attribute.

Break out of the img attribute by searching for:
`"><svg onload=alert(1)>`

## 4. DOM XSS in `innerHTML` sink using source `location.search`

Enter the following into the into the search box:
`<img src=1 onerror=alert(1)>`

Click "Search".

The value of the src attribute is invalid and throws an error. This triggers the onerror event handler, which then calls the alert() function. As a result, the payload is executed whenever the user's browser attempts to load the page containing your malicious post.

## 5. DOM XSS in jQuery anchor href attribute sink using location.search source

## 6. DOM XSS in jQuery selector sink using a hashchange event

## 7. Reflected XSS into attribute with angle brackets HTML-encoded

## 8. Stored XSS into anchor href attribute with double quotes HTML-encoded

## 9. Reflected XSS into a JavaScript string with angle brackets HTML encoded

## 10. DOM XSS in document.write sink using source location.search inside a select element

On the product pages, right click to inspect if a storeId parameter from the location.search source. It then uses document.write to create a new option in the select element for the stock checker functionality.

Add a storeId query parameter to the URL and enter a random alphanumeric string as its value. It could likely: `product?productId=1&storeId=1`. Request this modified URL.

In the browser, notice that your random string is now listed as one of the options in the drop-down list.

Right-click and inspect the drop-down list to confirm that the value of your storeId parameter has been placed inside a select element.

Change the URL to include a suitable XSS payload inside the storeId parameter as follows:

`product?productId=1&storeId="></select><img%20src=1%20onerror=alert(1)>`
